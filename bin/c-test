#!/bin/bash
#
# Author: bwangel<bwangel.me@gmail.com>
# Date: Mar,16,2017 10:24

PWD=$(pwd)

run_tests() {
    make && {
        for input in $(ls inputs);do
            diff <(./main.out < inputs/${input}) outputs/${input} && echo "${input} -- [ok]"
        done
    } && return 0
    return 1
}

init_tests() {
    dirs=( "inputs" "outputs" )
    for dir in ${dirs[@]};do
        [[ -d "${PWD}/${dir}" ]] || mkdir ${PWD}/${dir}
    done
    return 0
}

case "$1" in
    init)
        init_tests
        ;;
    test)
        run_tests
        ;;
    *)
        echo "Usage: $NAME {init|test}" >&2
        exit 3
        ;;
esac
